<script>
  const dragonCount = Math.floor(Math.random() * 25) + 5; // 5â€“20
  const dragons = [];
  const orbits = [];
  const scales = [];
  const specialEffects = []; // mark if this image gets the oval effect

  // Image pool
  const imageSources = ["eartth.png", "mondo.png", "terra.png"];

  for (let i = 0; i < dragonCount; i++) {
    const dragon = document.createElement("img");

    dragon.src = imageSources[Math.floor(Math.random() * imageSources.length)];
    dragon.alt = "Flying Object";
    dragon.id = "dragon" + i;

    const baseSize = 40 + Math.random() * 120;

    Object.assign(dragon.style, {
      position: "fixed",
      width: `${baseSize}px`,
      height: "auto",
      pointerEvents: "none",
      zIndex: "9999",
      top: "0",
      left: "0",
      transition: "transform 0.1s linear",
    });

    document.body.appendChild(dragon);
    dragons.push(dragon);

    // orbit settings
    const maxRadius = Math.min(window.innerWidth, window.innerHeight) * 0.4; // 80% screen
    orbits.push({
      radius: 200 + Math.random() * maxRadius,
      angle: Math.random() * Math.PI * 2,
      speed: 0.0015 + Math.random() * 0.004,
      centerX: window.innerWidth / 2,
      centerY: window.innerHeight / 2,
    });

    scales.push({
      base: 1,
      delta: Math.random() * 0.015 + 0.01,
      current: 1,
      direction: Math.random() > 0.5 ? 1 : -1,
    });

    // 25% chance of special oval spinning effect
    specialEffects.push(Math.random() < 0.25);
  }

  function animateDragons() {
    dragons.forEach((dragon, i) => {
      const orbit = orbits[i];
      const scale = scales[i];

      orbit.angle += orbit.speed;

      // pulsing
      scale.current += scale.delta * scale.direction;
      if (scale.current > 2.5 || scale.current < 0.5) scale.direction *= -1;

      let x = orbit.centerX + orbit.radius * Math.cos(orbit.angle);
      let y = orbit.centerY + orbit.radius * Math.sin(orbit.angle);
      let transform = `translate(${x}px, ${y}px) scale(${scale.current})`;

      // special oval spinning effect
      if (specialEffects[i]) {
        // elongate into ellipse: scaleX > scaleY
        const ellipseScaleX = 1.8 * scale.current;
        const ellipseScaleY = 0.8 * scale.current;

        // rotation (spin)
        const rotation = (orbit.angle * 180 / Math.PI) % 360;
        transform += ` rotate(${rotation}deg) scale(${ellipseScaleX}, ${ellipseScaleY})`;
      }

      dragon.style.transform = transform;
    });
    requestAnimationFrame(animateDragons);
  }
  animateDragons();
</script>
