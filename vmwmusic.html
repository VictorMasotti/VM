<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MusicVIC---TOR</title>
<link rel="icon" type="image/x-icon" href="pinkfav.png">

<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  font-family: 'Inter', sans-serif;
  background-color: #C9CED4;
  cursor: url('EARTH2.png'), auto;
}

/* FORCE CUSTOM CURSOR EVERYWHERE */
*, a, a:hover, a:active, a:visited, button, div, .glassButton {
  cursor: url('EARTH2.png'), auto !important;
}

-webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  user-select: none;
}

/* Remove blue highlight on touch */
* {
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
}
.container {
  position: absolute;
  top: 2vh;
  left: 2vw;
  width: calc(100% - 4vw);
  height: calc(100% - 4vh);
  display: flex;
  flex-direction: column;
  gap: 0.4vh;
  border-radius: 2vh;
}
.sectionA {
  flex: 0 0 auto;
  max-width: 100%;
  aspect-ratio: 5 / 1;
  display: flex;
  flex-wrap: wrap;
  gap: 0.5vh;
  padding: 0.5vh;
  border-radius: 1.5vh;
  background: #2F3035;
  position: relative;
}
.sectionA .block1,
.sectionA .block2,
.sectionA .block5 {
  flex: 1 0 calc(20% - 0.5vh);
  aspect-ratio: 1 / 1;
  background: #C9CED4;
  border-radius: 1.5vh;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  box-shadow: 0 4px 8px rgba(0,0,0,0.25),
              inset 0 -2px 6px rgba(0,0,0,0.15);
}
.sectionA .block3_4 {
  flex: 2 0 calc(40% - 0.5vh);
  aspect-ratio: 2 / 1;
  border-radius: 1.5vh;
  background: #111;
  overflow: hidden;
}
.block2 .insetImage {
  position: absolute;
  inset: 10%;
  border-radius: 1.2vh;
  overflow: hidden;
}
.block2 .insetImage img {
  width: 100%;
  height: 100%;
  object-fit: cover;
}
.sectionB {
  flex: 0 0 auto;
  max-width: 100%;
  aspect-ratio: 5 / 1;
  display: flex;
  flex-wrap: wrap;
  gap: 0.5vh;
  padding: 0.5vh;
  border-radius: 1.5vh;
  background: #2F3035;
  position: relative;
}
.sectionB .block {
  flex: 1 0 calc(10% - 0.5vh);
  aspect-ratio: 1/1;
  background: #C9CED4;
  border-radius: 1.5vh;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  overflow: hidden;
  box-shadow: 0 4px 8px rgba(0,0,0,0.25),
              inset 0 -2px 6px rgba(0,0,0,0.15);
}
.sectionC {
  flex: 1 1 auto;
  min-height: 20%;
}
.sectionB, .sectionC {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5vh;
  padding: 0.5vh;
  border-radius: 1.5vh;
  background: #2F3035;
  position: relative;
}
.sectionB .block {
  flex: 1 0 calc(10% - 0.5vh);
  aspect-ratio: 1/1;
  background: #C9CED4;
  border-radius: 1.5vh;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  overflow: hidden;
  box-shadow: 0 4px 8px rgba(0,0,0,0.25),
              inset 0 -2px 6px rgba(0,0,0,0.15);
}
.sectionC .block {
  flex: 1 0 calc(10% - 0.5vh);
  width: calc(10% - 0.5vh);
  background: #C9CED4;
  border-radius: 1.5vh;
  display: flex;
  justify-content: center;
  align-items: center;
  position: relative;
  overflow: visible;
  box-shadow: 0 4px 8px rgba(0,0,0,0.25),
              inset 0 -2px 6px rgba(0,0,0,0.15);
  padding: 9% 0;
}

.sectionC .sliderTrack {
  position: absolute;
  top: 9%;
  bottom: 9%;
  left: 50%;
  transform: translateX(-50%);
  width: 8px;
  background: linear-gradient(
    180deg,
    rgba(255,255,255,0.4),
    rgba(0,0,0,0.15)
  );
  border-radius: 4px;
  box-shadow: 
    inset 0 2px 4px rgba(0,0,0,0.3),
    inset 0 -2px 4px rgba(255,255,255,0.2);
}

.sectionC .sliderKnob {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: 75%;
  aspect-ratio: 1/1;
  border-radius: 50%;
  background: radial-gradient(
    circle at 35% 35%,
    rgba(255,255,255,0.5),
    rgba(255,255,255,0.15) 40%,
    rgba(0,0,0,0.05)
  );
  backdrop-filter: blur(10px);
  box-shadow:
    6px 6px 12px rgba(0,0,0,0.3),
    inset 0 2px 4px rgba(255,255,255,0.5),
    inset 0 -2px 4px rgba(0,0,0,0.2);
  border: 1px solid rgba(255,255,255,0.3);
  cursor: grab;
  touch-action: none;
  z-index: 10;
}

.sectionC .sliderKnob:active {
  cursor: grabbing;
}
.glassButton {
  width: 75%;
  height: auto;
  aspect-ratio: 1/1;
  max-height: 75%;
  border-radius: 50%;
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  background: linear-gradient(
    145deg,
    rgba(255,255,255,0.35),
    rgba(255,255,255,0.08)
  );
  backdrop-filter: blur(14px) saturate(130%);
  box-shadow:
    6px 6px 16px rgba(0,0,0,0.35),
    10px 10px 24px rgba(0,0,0,0.25),
    inset 0 -6px 12px rgba(0,0,0,0.35),
    inset 0 3px 6px rgba(255,255,255,0.55),
    inset -3px -3px 8px rgba(0,0,0,0.2),
    inset 3px 3px 8px rgba(255,255,255,0.3);
  will-change: transform;
  border: 1px solid rgba(255,255,255,0.2);
  overflow: hidden;
}

.glassButton::before {
  content: '';
  position: absolute;
  top: 5%;
  left: 5%;
  width: 45%;
  height: 45%;
  background: radial-gradient(
    circle at 35% 35%,
    rgba(255,255,255,0.65) 0%,
    rgba(255,255,255,0.35) 25%,
    rgba(255,255,255,0.12) 50%,
    transparent 75%
  );
  border-radius: 50%;
  filter: blur(3px);
  pointer-events: none;
  clip-path: polygon(0 0, 100% 0, 0 100%);
}
.block5 .glassButton {
  width: 75%;
  height: 75%;
  transition: all 5s ease-in-out;
}
.blockInnerCircle {
  position: absolute;
  width: 55%;
  height: 55%;
  top: 22.5%;
  left: 22.5%;
  border-radius: 50%;
  box-shadow:
    inset 0 2px 4px rgba(255,255,255,0.35),
    inset 0 -3px 6px rgba(0,0,0,0.35);
  pointer-events: none;
}
.secondaryCircle {
  position: absolute;
  inset: 0;
  border-radius: 50%;
  background: radial-gradient(
    circle at 30% 30%,
    rgba(255,255,255,0.35),
    rgba(0,0,0,0.15)
  );
  box-shadow:
    inset 0 3px 6px rgba(255,255,255,0.25),
    inset 0 -6px 10px rgba(0,0,0,0.45);
  pointer-events: none;
}
.block1 canvas {
  width: 100%;
  height: 100%;
  image-rendering: pixelated;
}
.glassButton img {
  width: 60%; /* reduced by 20% */
  height: 60%;
  object-fit: contain;
  pointer-events: none;
}
</style>
</head>

<body>
<div class="container">

<section class="section sectionA">
  <div class="block block1">
    <canvas id="dotMatrix"></canvas>
  </div>

  <div class="block block2">
    <div class="insetImage">
      <img id="randomImage">
    </div>
  </div>

  <div class="block block3_4">
    <img src="aud.gif" style="width:100%;height:100%;object-fit:cover;border-radius:1.5vh;">
  </div>

  <div class="block block5">
    <div class="glassButton"></div>
  </div>
</section>

<section class="section sectionB" id="sectionB"></section>
<section class="section sectionC" id="sectionC"></section>

</div>

<script>
/* AUDIO */
const audio = new Audio('breakTHROUGH.mp3');
audio.preload = 'auto';
const gif = document.querySelector('.block3_4 img');
gif.addEventListener('load', () => { audio.play().catch(()=>{}); });

let audioUnlocked = false;
document.addEventListener('click', () => {
    if(!audioUnlocked){ audio.play().catch(()=>{}); audioUnlocked = true; }
});

// Web Audio API setup
const audioContext = new (window.AudioContext || window.webkitAudioContext)();
const source = audioContext.createMediaElementSource(audio);

// Create audio nodes
const gainNode = audioContext.createGain(); // Volume
const lowPassFilter = audioContext.createBiquadFilter(); // Filter 1
const highPassFilter = audioContext.createBiquadFilter(); // Filter 2
const bassEQ = audioContext.createBiquadFilter(); // Bass
const trebleEQ = audioContext.createBiquadFilter(); // Treble
const panNode = audioContext.createStereoPanner(); // Pan
const compressor = audioContext.createDynamicsCompressor(); // Compressor
const convolverNode = audioContext.createConvolver(); // Reverb (needs impulse response)

// Configure filters
lowPassFilter.type = 'lowpass';
lowPassFilter.frequency.value = 20000; // Default: no filtering
highPassFilter.type = 'highpass';
highPassFilter.frequency.value = 20; // Default: no filtering
bassEQ.type = 'lowshelf';
bassEQ.frequency.value = 200;
bassEQ.gain.value = 0;
trebleEQ.type = 'highshelf';
trebleEQ.frequency.value = 3000;
trebleEQ.gain.value = 0;
panNode.pan.value = 0; // Center

// Connect audio chain
source.connect(gainNode);
gainNode.connect(lowPassFilter);
lowPassFilter.connect(highPassFilter);
highPassFilter.connect(bassEQ);
bassEQ.connect(trebleEQ);
trebleEQ.connect(panNode);
panNode.connect(compressor);
compressor.connect(audioContext.destination);

// Slider effect mappings
const sliderEffects = [
  { // Slider 1: Pitch Shift
    name: 'Pitch',
    apply: (value) => {
      // -100 to +100 -> 0.5x to 2x playback rate
      audio.playbackRate = 1 + (value / 100);
    }
  },
  { // Slider 2: Low-Pass Filter
    name: 'Low-Pass',
    apply: (value) => {
      // -100 = 200Hz (very muffled), 0 = 20000Hz (no effect), +100 = 20000Hz
      if (value <= 0) {
        lowPassFilter.frequency.value = 200 + ((100 + value) / 100) * 19800;
      } else {
        lowPassFilter.frequency.value = 20000; // No filtering on positive
      }
    }
  },
  { // Slider 3: High-Pass Filter
    name: 'High-Pass',
    apply: (value) => {
      // -100 = 20Hz (no effect), 0 = 20Hz, +100 = 5000Hz (very tinny)
      if (value >= 0) {
        highPassFilter.frequency.value = 20 + (value / 100) * 4980;
      } else {
        highPassFilter.frequency.value = 20; // No filtering on negative
      }
    }
  },
  { // Slider 4: Bass Boost/Cut
    name: 'Bass',
    apply: (value) => {
      // -100 to +100 -> -20dB to +20dB
      bassEQ.gain.value = (value / 100) * 20;
    }
  },
  { // Slider 5: Treble Boost/Cut
    name: 'Treble',
    apply: (value) => {
      // -100 to +100 -> -20dB to +20dB
      trebleEQ.gain.value = (value / 100) * 20;
    }
  },
  { // Slider 6: Stereo Pan
    name: 'Pan',
    apply: (value) => {
      // -100 to +100 -> -1 (left) to +1 (right)
      panNode.pan.value = value / 100;
    }
  },
  { // Slider 7: Volume
    name: 'Volume',
    apply: (value) => {
      // -100 to +100 -> 0 (silent) to 2 (2x volume)
      gainNode.gain.value = Math.max(0, 1 + (value / 100));
    }
  },
  { // Slider 8: Playback Speed
    name: 'Speed',
    apply: (value) => {
      // -100 to +100 -> 0.25x to 2x speed (preserves pitch if detune used)
      audio.playbackRate = Math.max(0.25, 1 + (value / 100));
    }
  },
  { // Slider 9: Compression
    name: 'Compress',
    apply: (value) => {
      // -100 = no compression, +100 = heavy compression
      if (value >= 0) {
        compressor.threshold.value = -50 + (value / 100) * 40; // -50 to -10
        compressor.ratio.value = 1 + (value / 100) * 19; // 1:1 to 20:1
      } else {
        compressor.threshold.value = 0; // Disabled
        compressor.ratio.value = 1;
      }
    }
  },
  { // Slider 10: Distortion (using gain overdrive)
    name: 'Distortion',
    apply: (value) => {
      // Simple distortion using volume boost
      if (value > 0) {
        gainNode.gain.value = 1 + (value / 100) * 4; // Up to 5x gain
      }
    }
  }
];

/* RANDOM IMAGE */
const imgs = ['corala.png','scattershot.png'];
document.getElementById('randomImage').src =
  imgs[Math.floor(Math.random()*imgs.length)];

/* MATRIX DOTS */
const canvas = document.getElementById('dotMatrix');
const ctx = canvas.getContext('2d');
function resize(){ canvas.width=canvas.offsetWidth; canvas.height=canvas.offsetHeight; }
resize(); window.addEventListener('resize', resize);

const gs=20, dr=4;
let pulsePhase = 0;

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const cx=canvas.width/2, cy=canvas.height/2;
  const r=Math.min(canvas.width,canvas.height)/2*0.85;
  
  // Speaker cone pulse - SLOWER by 25%
  pulsePhase += 0.0375; // Was 0.05, now 75% of that
  const pulseFactor = Math.sin(pulsePhase) * 1.2; // MUCH MORE WARP (was 0.6, now 1.2)
  
  // Draw warped grey background as triangle mesh
  ctx.fillStyle = '#C9CED4';
  const segments = 30;
  for(let ring=0; ring<segments; ring++) {
    const innerRadius = (ring / segments) * r;
    const outerRadius = ((ring + 1) / segments) * r;
    const steps = 40;
    
    for(let i=0; i<steps; i++) {
      const angle1 = (i / steps) * Math.PI * 2;
      const angle2 = ((i + 1) / steps) * Math.PI * 2;
      
      // Calculate cone depth for each ring - DOUBLED warp
      const innerNorm = 1 - ring / segments;
      const outerNorm = 1 - (ring + 1) / segments;
      const innerDepth = innerNorm * pulseFactor * 50; // Was 30, now 50
      const outerDepth = outerNorm * pulseFactor * 50;
      
      // Inner ring points with MORE contraction
      const ix1 = cx + Math.cos(angle1) * (innerRadius - innerDepth * 0.5);
      const iy1 = cy + Math.sin(angle1) * (innerRadius - innerDepth * 0.5);
      const ix2 = cx + Math.cos(angle2) * (innerRadius - innerDepth * 0.5);
      const iy2 = cy + Math.sin(angle2) * (innerRadius - innerDepth * 0.5);
      
      // Outer ring points
      const ox1 = cx + Math.cos(angle1) * (outerRadius - outerDepth * 0.5);
      const oy1 = cy + Math.sin(angle1) * (outerRadius - outerDepth * 0.5);
      const ox2 = cx + Math.cos(angle2) * (outerRadius - outerDepth * 0.5);
      const oy2 = cy + Math.sin(angle2) * (outerRadius - outerDepth * 0.5);
      
      // DRAMATIC shading based on depth and ring position
      const avgDepth = (innerDepth + outerDepth) / 2;
      const depthFactor = avgDepth / 60; // How deep is this ring
      
      let brightness;
      if (pulseFactor > 0) {
        // Pushed OUT - brighter center, darker edges
        brightness = 201 - innerNorm * 40 + depthFactor * 50;
      } else {
        // Sucked IN - much darker center (deep cone shadow)
        brightness = 201 - innerNorm * 80 - Math.abs(depthFactor) * 60;
      }
      
      brightness = Math.max(50, Math.min(255, brightness));
      ctx.fillStyle = `rgb(${brightness}, ${brightness+4}, ${brightness+8})`;
      
      // Draw quad as two triangles
      ctx.beginPath();
      ctx.moveTo(ix1, iy1);
      ctx.lineTo(ox1, oy1);
      ctx.lineTo(ox2, oy2);
      ctx.lineTo(ix2, iy2);
      ctx.closePath();
      ctx.fill();
    }
  }
  
  // Draw dots on the warped surface
  const s=(2*r)/(gs-1);
  const dotRadius = Math.max(2, Math.min(dr, s * 0.15));
  
  for(let y=0;y<gs;y++)for(let x=0;x<gs;x++){
    const baseX=cx-r+x*s, baseY=cy-r+y*s;
    const distFromCenter = Math.hypot(baseX-cx, baseY-cy);
    
    if(distFromCenter <= r){
      const normalizedDist = distFromCenter / r;
      const dotDepth = (1 - normalizedDist) * pulseFactor * 50; // Matches background warp
      
      // Move dot with the warped surface
      const angle = Math.atan2(baseY - cy, baseX - cx);
      const warpedRadius = distFromCenter - dotDepth * 0.5;
      const px = cx + Math.cos(angle) * warpedRadius;
      const py = cy + Math.sin(angle) * warpedRadius;
      
      const rnd=Math.random()*99;
      let col='#000';
      if(rnd<2) col='#ff8000';
      else if(rnd<2.6) col='#ffb343';
      else if(rnd<3) col='#40bcf4';
      
      // Dots get smaller when deeper, with MORE dramatic scaling
      const scale = Math.max(0.3, 1 - Math.abs(dotDepth) / 70);
      
      ctx.beginPath();
      ctx.arc(px, py, dotRadius * scale, 0, Math.PI*2);
      ctx.fillStyle = col;
      ctx.fill();
    }
  }
}
setInterval(draw,35); draw();

/* BUTTON CREATION */
function createBlocks(section,num,addHomeIcon=false){
  for(let i=0;i<num;i++){
    const block=document.createElement('div');
    block.className='block';
    const btn=document.createElement('div');
    btn.className='glassButton';

    // Click ripple effect
    btn.addEventListener('click',()=>{      
      const s=document.createElement('div');
      s.className='secondaryCircle';
      btn.appendChild(s);
      s.animate(
        [{transform:'scale(1)',opacity:1},{transform:'scale(0.82)',opacity:0}],
        {duration:900,easing:'cubic-bezier(0.25,1,0.5,1)'}
      );
      setTimeout(()=>s.remove(),900);

      const nova=document.createElement('div');
      nova.style.position='absolute';
      nova.style.top='50%';
      nova.style.left='50%';
      nova.style.width='100%';
      nova.style.height='100%';
      nova.style.transform='translate(-50%,-50%)';
      nova.style.borderRadius='50%';
      nova.style.background='rgba(180,180,180,0.5)';
      nova.style.filter='blur(4px)';
      nova.style.pointerEvents='none';
      btn.appendChild(nova);
      nova.animate(
        [{transform:'translate(-50%,-50%) scale(1)',opacity:1},
         {transform:'translate(-50%,-50%) scale(1.4)',opacity:0}],
        {duration:1100,easing:'ease-out'}
      );
      setTimeout(()=>nova.remove(),1100);
    });

    // Home icon for first block
    if(addHomeIcon && i===0){
      const link = document.createElement('a');
      link.href = 'https://victormasotti.com/';
      link.style.display = 'flex';
      link.style.justifyContent = 'center';
      link.style.alignItems = 'center';
      link.style.width = '100%';
      link.style.height = '100%';

      const homeIcon = document.createElement('img');
      homeIcon.src = 'home.png';
      homeIcon.style.width = '60%'; // reduced size
      homeIcon.style.height = '60%';
      homeIcon.style.objectFit = 'contain';
      homeIcon.style.pointerEvents = 'none';

      link.appendChild(homeIcon);
      btn.appendChild(link);
    }

    block.appendChild(btn);
    section.appendChild(block);
  }
}

const sectionB=document.getElementById('sectionB');
const sectionC=document.getElementById('sectionC');
createBlocks(sectionB,20,true);
createBlocks(sectionC,10);

/* Add paint.png icon to button 10 */
const button10Icon = sectionB.children[9].querySelector('.glassButton');
if (button10Icon) {
  const paintIcon = document.createElement('img');
  paintIcon.src = 'paint.png';
  paintIcon.style.width = '60%';
  paintIcon.style.height = '60%';
  paintIcon.style.objectFit = 'contain';
  paintIcon.style.pointerEvents = 'none';
  button10Icon.appendChild(paintIcon);
}

/* Create sliders for Section C */
[...sectionC.children].forEach((block, index) => {
  // Remove glass button if exists
  const existingBtn = block.querySelector('.glassButton');
  if (existingBtn) existingBtn.remove();
  
  // Create slider track
  const track = document.createElement('div');
  track.className = 'sliderTrack';
  block.appendChild(track);
  
  // Create slider knob
  const knob = document.createElement('div');
  knob.className = 'sliderKnob';
  block.appendChild(knob);
  
  // Slider state
  let isDragging = false;
  let sliderValue = 0; // -100 to +100, default 0 (middle = no effect)
  
  function updateKnobPosition(value) {
    const blockHeight = block.offsetHeight;
    const knobHeight = knob.offsetHeight;
    const borderSpace = blockHeight * 0.09;
    
    // Position knob: -100 at bottom, 0 at middle, +100 at top
    const minPos = borderSpace;
    const maxPos = blockHeight - borderSpace - knobHeight;
    const middlePos = (minPos + maxPos) / 2;
    const range = (maxPos - minPos) / 2;
    const position = middlePos - (value / 100) * range;
    
    knob.style.top = `${position}px`;
  }
  
  function handleMove(clientY) {
    if (!isDragging) return;
    
    const rect = block.getBoundingClientRect();
    const blockHeight = rect.height;
    const knobHeight = knob.offsetHeight;
    const borderSpace = blockHeight * 0.09;
    
    const minY = rect.top + borderSpace;
    const maxY = rect.bottom - borderSpace - knobHeight;
    const middleY = (minY + maxY) / 2;
    const range = (maxY - minY) / 2;
    
    // Calculate slider value: top = +100, middle = 0, bottom = -100
    const relativeY = clientY - middleY;
    const clampedY = Math.max(-range, Math.min(range, relativeY));
    sliderValue = Math.round(-(clampedY / range) * 100);
    
    updateKnobPosition(sliderValue);
    
    // Apply audio effect
    if (sliderEffects[index]) {
      sliderEffects[index].apply(sliderValue);
    }
  }
  
  // Mouse events
  knob.addEventListener('mousedown', (e) => {
    isDragging = true;
    e.preventDefault();
  });
  
  // Use window for global tracking
  window.addEventListener('mousemove', (e) => {
    if (isDragging) {
      e.preventDefault();
      handleMove(e.clientY);
    }
  });
  
  window.addEventListener('mouseup', () => {
    isDragging = false;
  });
  
  // Touch events
  knob.addEventListener('touchstart', (e) => {
    isDragging = true;
    e.preventDefault();
  }, {passive: false});
  
  document.addEventListener('touchmove', (e) => {
    if (isDragging && e.touches[0]) {
      handleMove(e.touches[0].clientY);
    }
  }, {passive: false});
  
  document.addEventListener('touchend', () => {
    isDragging = false;
  });
  
  // Initialize position
  updateKnobPosition(sliderValue);
});

/* Volume controls for buttons 2 and 3 */
const button2 = sectionB.children[1]; // Second button (index 1)
const button3 = sectionB.children[2]; // Third button (index 2)

// Add less.png icon to button 2
const btn2 = button2.querySelector('.glassButton');
const lessIcon = document.createElement('img');
lessIcon.src = 'less.png';
lessIcon.style.width = '60%';
lessIcon.style.height = '60%';
lessIcon.style.objectFit = 'contain';
lessIcon.style.pointerEvents = 'none';
btn2.appendChild(lessIcon);

// Add more.png icon to button 3
const btn3 = button3.querySelector('.glassButton');
const moreIcon = document.createElement('img');
moreIcon.src = 'more.png';
moreIcon.style.width = '60%';
moreIcon.style.height = '60%';
moreIcon.style.objectFit = 'contain';
moreIcon.style.pointerEvents = 'none';
btn3.appendChild(moreIcon);

// Button 2: Lower volume by 5% with light beige shade
button2.querySelector('.glassButton').addEventListener('click', (e) => {
  audio.volume = Math.max(0, audio.volume - 0.05);
  console.log('Volume decreased to:', Math.round(audio.volume * 100) + '%');
  
  e.stopPropagation();
  
  const btn = button2.querySelector('.glassButton');
  
  // Light beige tinted secondary circle
  const s = document.createElement('div');
  s.className = 'secondaryCircle';
  s.style.background = 'radial-gradient(circle at 30% 30%, rgba(215, 207, 189, 0.35), rgba(0, 0, 0, 0.15))';
  btn.appendChild(s);
  s.animate(
    [{transform:'scale(1)',opacity:1},{transform:'scale(0.82)',opacity:0}],
    {duration:900,easing:'cubic-bezier(0.25,1,0.5,1)'}
  );
  setTimeout(()=>s.remove(),900);

  // Light beige nova
  const nova = document.createElement('div');
  nova.style.position = 'absolute';
  nova.style.top = '50%';
  nova.style.left = '50%';
  nova.style.width = '100%';
  nova.style.height = '100%';
  nova.style.transform = 'translate(-50%,-50%)';
  nova.style.borderRadius = '50%';
  nova.style.background = 'rgba(215, 207, 189, 0.4)';
  nova.style.filter = 'blur(6px)';
  nova.style.pointerEvents = 'none';
  btn.appendChild(nova);
  nova.animate(
    [{transform:'translate(-50%,-50%) scale(1)',opacity:1},
     {transform:'translate(-50%,-50%) scale(1.4)',opacity:0}],
    {duration:1100,easing:'ease-out'}
  );
  setTimeout(()=>nova.remove(),1100);
});

// Button 3: Raise volume by 5% with light beige shade
button3.querySelector('.glassButton').addEventListener('click', (e) => {
  audio.volume = Math.min(1, audio.volume + 0.05);
  console.log('Volume increased to:', Math.round(audio.volume * 100) + '%');
  
  e.stopPropagation();
  
  const btn = button3.querySelector('.glassButton');
  
  // Light beige tinted secondary circle
  const s = document.createElement('div');
  s.className = 'secondaryCircle';
  s.style.background = 'radial-gradient(circle at 30% 30%, rgba(215, 207, 189, 0.35), rgba(0, 0, 0, 0.15))';
  btn.appendChild(s);
  s.animate(
    [{transform:'scale(1)',opacity:1},{transform:'scale(0.82)',opacity:0}],
    {duration:900,easing:'cubic-bezier(0.25,1,0.5,1)'}
  );
  setTimeout(()=>s.remove(),900);

  // Light beige nova
  const nova = document.createElement('div');
  nova.style.position = 'absolute';
  nova.style.top = '50%';
  nova.style.left = '50%';
  nova.style.width = '100%';
  nova.style.height = '100%';
  nova.style.transform = 'translate(-50%,-50%)';
  nova.style.borderRadius = '50%';
  nova.style.background = 'rgba(215, 207, 189, 0.4)';
  nova.style.filter = 'blur(6px)';
  nova.style.pointerEvents = 'none';
  btn.appendChild(nova);
  nova.animate(
    [{transform:'translate(-50%,-50%) scale(1)',opacity:1},
     {transform:'translate(-50%,-50%) scale(1.4)',opacity:0}],
    {duration:1100,easing:'ease-out'}
  );
  setTimeout(()=>nova.remove(),1100);
});

/* 4-color inner circles */
const colors=['#ff8000','#00e054','#ffb343','#40bcf4'];
[...sectionB.children].slice(4,8).forEach((block,i)=>{
  const c=document.createElement('div');
  c.className='blockInnerCircle';
  c.style.background=colors[i];
  block.querySelector('.glassButton').appendChild(c);
});

// Block5 gets Falun red instead of green
const block5colors=['#ff8000','#00e054','#ffb343','#801818'];
block5colors.forEach(col=>{
  const c=document.createElement('div');
  c.className='blockInnerCircle';
  c.style.background=col;
  document.querySelector('.block5 .glassButton').appendChild(c);
});

/* Block5 random time */
document.querySelector('.block5 .glassButton').addEventListener('click', (e) => {
    const maxTime = 85;
    const randomTime = Math.random() * maxTime;
    audio.currentTime = randomTime;
    audio.play().catch(()=>{});
    
    e.stopPropagation();
    
    const btn = document.querySelector('.block5 .glassButton');
    
    // Secondary circle ripple
    const s = document.createElement('div');
    s.className = 'secondaryCircle';
    s.style.background = 'radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.25), rgba(0, 0, 0, 0.15))';
    btn.appendChild(s);
    s.animate(
      [{transform:'scale(1)',opacity:1},{transform:'scale(0.82)',opacity:0}],
      {duration:900,easing:'ease-out'}
    ).onfinish=()=>s.remove();
    
    // Nova burst
    const n = document.createElement('div');
    n.className = 'secondaryCircle';
    n.style.background = 'radial-gradient(circle, rgba(255,255,255,0.5) 0%, transparent 70%)';
    btn.appendChild(n);
    n.animate(
      [{transform:'scale(1)',opacity:0.8},{transform:'scale(1.4)',opacity:0}],
      {duration:1100,easing:'ease-out'}
    ).onfinish=()=>n.remove();
});

/* Button 10 - Color Scheme Cycler */
let currentMode = 0; // 0 = original, 1 = beige, 2 = LEGO blue, 3 = rust orange
const button10 = sectionB.children[9]; // 10th button (index 9)

const colorSchemes = [
  // Mode 0: Original
  {
    name: 'Original',
    sectionABlocks: '#C9CED4',
    sectionBCBlocks: '#C9CED4',
    bodyBg: '#C9CED4',
    greenCircle: '#801818', // Falun red (default)
    block5Glass: null, // No special effect
    showText: false
  },
  // Mode 1: Beige & Green
  {
    name: 'Mode 2 Activated',
    sectionABlocks: '#209569',
    sectionBCBlocks: '#e6dacc',
    bodyBg: '#e6dacc',
    greenCircle: '#801818', // Falun red
    block5Glass: {
      border: '2px solid rgba(0, 0, 0, 0.6)',
      boxShadow: `
        0 8px 16px rgba(0,0,0,0.4),
        0 4px 8px rgba(0,0,0,0.3),
        inset 0 1px 0 rgba(255,255,255,0.6),
        inset 0 -1px 0 rgba(0,0,0,0.3),
        inset -2px -4px 8px rgba(0,0,0,0.25),
        inset 2px 4px 8px rgba(255,255,255,0.4)
      `,
      background: 'linear-gradient(145deg, rgba(255,255,255,0.35), rgba(255,255,255,0.08))'
    },
    showText: true,
    textColor: '#4a7c59'
  },
  // Mode 2: LEGO Bright Blue & White
  {
    name: 'Mode 3 Activated',
    sectionABlocks: '#00A3DA', // LEGO bright light blue
    sectionBCBlocks: '#FFFFFF', // White
    bodyBg: '#FFFFFF',
    greenCircle: '#003D7A', // Dark blue
    block5Glass: null,
    showText: true,
    textColor: '#00A3DA'
  },
  // Mode 3: Rust Orange & Green Ash
  {
    name: 'Mode 4 Activated',
    sectionABlocks: '#B7410E', // Rust orange
    sectionBCBlocks: '#A8B5A0', // Green ash
    bodyBg: '#A8B5A0',
    greenCircle: '#6B3A2E', // Dark sand red
    block5Glass: null,
    showText: true,
    textColor: '#B7410E'
  },
  // Mode 4: Bright Light Orange & Lime
  {
    name: 'Mode 5 Activated',
    sectionABlocks: '#C7EA46', // Lime
    sectionBCBlocks: '#FFB347', // Bright light orange
    bodyBg: '#FFB347',
    greenCircle: '#90EE90', // Light green
    block5Glass: null,
    showText: true,
    textColor: '#C7EA46'
  },
  // Mode 5: Magenta & Silver with Metallic Finish
  {
    name: 'Mode 6 Activated',
    sectionABlocks: '#C0C0C0', // Silver
    sectionBCBlocks: '#FF00FF', // Magenta
    bodyBg: '#FF00FF',
    greenCircle: '#A8A8A8', // Light silver gray
    block5Glass: null,
    showText: true,
    textColor: '#808080',
    metallic: true // Special flag for metallic effects
  }
];

button10.querySelector('.glassButton').addEventListener('click', () => {
  // Cycle to next mode
  currentMode = (currentMode + 1) % colorSchemes.length;
  const scheme = colorSchemes[currentMode];
  
  // Get all elements
  const greyBlocks = document.querySelectorAll('.sectionB .block, .sectionC .block, .block1, .block2, .block5');
  const sectionAGreyBlocks = document.querySelectorAll('.block1, .block2, .block5');
  const greenCircle = document.querySelector('.block5 .blockInnerCircle:nth-child(4)');
  const block5Button = document.querySelector('.block5 .glassButton');
  const allButtons = document.querySelectorAll('.glassButton');
  
  // Show mode text if enabled
  if (scheme.showText) {
    const modeText = document.createElement('div');
    modeText.id = 'mode2Text';
    modeText.textContent = scheme.name;
    modeText.style.position = 'fixed';
    modeText.style.top = '3vh';
    modeText.style.left = '3vw';
    modeText.style.fontSize = '3vh';
    modeText.style.fontWeight = '700';
    modeText.style.color = scheme.textColor;
    modeText.style.zIndex = '10000';
    modeText.style.opacity = '0';
    modeText.style.transition = 'opacity 1s ease-in-out';
    modeText.style.pointerEvents = 'none';
    modeText.style.fontFamily = 'Inter, sans-serif';
    document.body.appendChild(modeText);
    
    setTimeout(() => { modeText.style.opacity = '1'; }, 10);
    setTimeout(() => {
      modeText.style.opacity = '0';
      setTimeout(() => modeText.remove(), 1000);
    }, 12000);
  }
  
  // Apply Section A blocks color
  sectionAGreyBlocks.forEach(block => {
    block.style.transition = `background-color ${scheme.fadeTime ? scheme.fadeTime.sectionA : 6}s ease-in-out`;
    block.style.backgroundColor = scheme.sectionABlocks;
    
    // Add metallic gradient for scheme 6
    if (scheme.metallic) {
      block.style.background = `linear-gradient(145deg, 
        rgba(255,255,255,0.4), 
        ${scheme.sectionABlocks} 30%, 
        rgba(0,0,0,0.2) 70%, 
        rgba(255,255,255,0.3))`;
      block.style.boxShadow = `
        0 4px 8px rgba(0,0,0,0.25),
        inset 0 2px 4px rgba(255,255,255,0.8),
        inset 0 -2px 6px rgba(0,0,0,0.35),
        inset 2px 2px 8px rgba(255,255,255,0.5)`;
    } else {
      block.style.background = '';
      block.style.boxShadow = '0 4px 8px rgba(0,0,0,0.25), inset 0 -2px 6px rgba(0,0,0,0.15)';
    }
  });
  
  // Apply green circle color
  if (greenCircle) {
    greenCircle.style.transition = `background-color ${scheme.fadeTime ? scheme.fadeTime.sectionA : 6}s ease-in-out`;
    greenCircle.style.backgroundColor = scheme.greenCircle;
  }
  
  // Apply block5 glass effect
  if (scheme.block5Glass) {
    block5Button.style.transition = `all ${scheme.fadeTime ? scheme.fadeTime.sectionA : 6}s ease-in-out`;
    block5Button.style.border = scheme.block5Glass.border;
    block5Button.style.boxShadow = scheme.block5Glass.boxShadow;
    block5Button.style.background = scheme.block5Glass.background;
  } else {
    block5Button.style.transition = `all ${scheme.fadeTime ? scheme.fadeTime.sectionA : 6}s ease-in-out`;
    block5Button.style.border = '';
    block5Button.style.boxShadow = '';
    block5Button.style.background = '';
  }
  
  // Apply Section B & C blocks color
  const nonSectionABlocks = [...greyBlocks].filter(block => ![...sectionAGreyBlocks].includes(block));
  nonSectionABlocks.forEach(block => {
    block.style.transition = `background-color ${scheme.fadeTime ? scheme.fadeTime.sectionBC : 5}s ease-in-out`;
    block.style.backgroundColor = scheme.sectionBCBlocks;
    
    // Metallic effect for scheme 6
    if (scheme.metallic) {
      block.style.background = `linear-gradient(135deg, 
        rgba(255,255,255,0.3), 
        ${scheme.sectionBCBlocks} 40%, 
        rgba(0,0,0,0.15) 80%, 
        rgba(255,255,255,0.2))`;
    } else {
      block.style.background = '';
    }
  });
  
  // Apply body background
  document.body.style.transition = `background-color ${scheme.fadeTime ? scheme.fadeTime.sectionBC : 5}s ease-in-out`;
  document.body.style.backgroundColor = scheme.bodyBg;
  
  // Add metallic shine to buttons for scheme 6 only
  if (scheme.metallic) {
    allButtons.forEach(btn => {
      btn.style.background = `radial-gradient(circle at 35% 35%, 
        rgba(255,255,255,0.65), 
        rgba(255,255,255,0.25) 40%, 
        rgba(0,0,0,0.1))`;
      btn.style.boxShadow = `
        6px 6px 12px rgba(0,0,0,0.3),
        inset 0 3px 6px rgba(255,255,255,0.7),
        inset 0 -3px 6px rgba(0,0,0,0.3),
        inset -2px -2px 8px rgba(0,0,0,0.2),
        inset 2px 2px 8px rgba(255,255,255,0.5)`;
    });
  } else {
    // Reset buttons to normal glass style
    allButtons.forEach(btn => {
      btn.style.background = '';
      btn.style.boxShadow = '';
    });
  }
});

/* Cursor follow - independent blocks */
document.addEventListener('mousemove',e=>{
  [...sectionB.children,...sectionC.children,document.querySelector('.block5')]
  .forEach(block=>{
    const btn=block.querySelector('.glassButton');
    if(!btn) return;
    const r=block.getBoundingClientRect();
    const dx=e.clientX-(r.left+r.width/2);
    const dy=e.clientY-(r.top+r.height/2);
    const dist=Math.hypot(dx,dy);
    const strength=Math.max(0,1-dist/80)*2; // Reduced from 275 to 80 - much less attraction
    btn.style.transform=
      `translate(${dx*0.25*strength}px,${dy*0.25*strength}px)
       scale(${1+strength*0.05})`;
  });
});
</script>
</body>
</html>
